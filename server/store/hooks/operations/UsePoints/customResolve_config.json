{"path":"operations/UsePoints/customResolve","depend":null,"script":"import { HookRequestWithInput } from 'generated/fireboom.hooks'\nimport { InjectedUsePointsInput, UsePointsResponse } from 'generated/models'\n\nexport default async function customResolve(hook: HookRequestWithInput\u003cInjectedUsePointsInput\u003e)\n  //: Promise\u003cvoid | UsePointsResponse\u003e{ // 取消注释以使用严格的返回类型\n  : Promise\u003cany\u003e {\n  // TODO: 在此处添加代码\n  const resp = await hook.internalClient.queries.FindOneAppUser({\n    input: {\n      id: hook.user?.userId\n    }\n  })\n  // 积分不足时，跳过后续流程直接返回\n  const points = resp?.data?.data?.points ?? 0\n  if (points \u003c 1) {\n    return {\n      data: {},\n      errors: [{\n        message: '积分不足'\n      }]\n    }\n  }\n  // 修改用户积分\n  await hook.internalClient.mutations.DecreasePoints({\n    input: {\n      id: hook.input.id!,\n      points: 1\n    }\n  })\n}","switch":false,"scriptType":"","input":null,"type":""}